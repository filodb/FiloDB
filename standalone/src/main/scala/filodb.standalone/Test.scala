package filodb.standalone


import java.io.{File, FileOutputStream}
import java.nio.ByteBuffer

import filodb.core.metadata.{Dataset, DatasetOptions}



//scalastyle:off
//import filodb.core.DatasetRef
//import filodb.core.memstore.ratelimit.RocksDbCardinalityStore
//import filodb.prometheus.ast.TimeStepParams
//import filodb.prometheus.parse.Parser

//import java.util.Base64
//import filodb.core.binaryrecord2.{RecordContainer, RecordSchema}
//import filodb.core.metadata.Column
//import filodb.core.query.{ColumnInfo, CustomRangeVectorKey, RvRange, SerializedRangeVector}



object Test {


  def main(args: Array[String]): Unit = {

//      //val rc = "KAIAAAAAAAEj6tukhQEAABAAAADwaHGkhQEAAAAAAAAAAPA/EAAAAIijcaSFAQAAAAAAAAAA8D8QAAAAIN5xpIUBAAAAAAAAAAAAQBAAAAC4GHKkhQEAAAAAAAAAABBAEAAAAFBTcqSFAQAAAAAAAAAAFEAQAAAA6I1ypIUBAAAAAAAAAAAUQBAAAACAyHKkhQEAAAAAAAAAABRAEAAAABgDc6SFAQAAAAAAAAAAHEAQAAAAsD1zpIUBAAAAAAAAAAAcQBAAAABIeHOkhQEAAAAAAAAAABxAEAAAAOCyc6SFAQAAAAAAAAAAHEAQAAAAeO1zpIUBAAAAAAAAAAAcQBAAAAAQKHSkhQEAAAAAAAAAABxAEAAAAKhidKSFAQAAAAAAAAAAHEAQAAAAQJ10pIUBAAAAAAAAAAAcQBAAAADY13SkhQEAAAAAAAAAABxAEAAAAHASdaSFAQAAAAAAAAAAHEAQAAAACE11pIUBAAAAAAAAAAAcQBAAAACgh3WkhQEAAAAAAAAAABxAEAAAADjCdaSFAQAAAAAAAAAAHEAQAAAA0Px1pIUBAAAAAAAAAAAcQBAAAABoN3akhQEAAAAAAAAAABxAEAAAAABydqSFAQAAAAAAAAAAHEAQAAAAmKx2pIUBAAAAAAAAAAAcQBAAAAAw53akhQEAAAAAAAAAABxAEAAAAMghd6SFAQAAAAAAAAAAHEAQAAAAYFx3pIUBAAAAAAAAAAAcQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="
//      //val rc =                                        "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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="
//      val rc =                                         "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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=="
//
//
//
//
//
//    val bytes = Base64.getDecoder.decode(rc)
//      val schema = new RecordSchema( columns = List(
//        ColumnInfo("time", Column.ColumnType.LongColumn),
//        ColumnInfo("value", Column.ColumnType.DoubleColumn)))
//
//    val srv = new SerializedRangeVector(CustomRangeVectorKey(Map.empty),
//      27,
//      Seq(RecordContainer(bytes)),
//      schema,
//      58,
//      Some(RvRange(startMs = 1673500109000L, endMs = 1673501609000L, stepMs = 15000)))
//
//    println(srv.prettyPrint(true))

//    val query = """sum(
//      rate(container_cpu_cfs_throttled_periods_total{_ws_="aci-kubernetes", _ns_="us-west-1a", namespace="icloud-accounts-carry", container="memcached-accountservice-metadata-lock", pod=~"prod-p98-memcached-accountservice-metadata-lock-.*", pod!~"prod-p98-memcached-accountservice-metadata-lock-test-.*"}[5m])
//    )
//    /
//    sum(
//      rate(container_cpu_cfs_periods_total{_ws_="aci-kubernetes", _ns_="us-west-1a", namespace="icloud-accounts-carry", container="memcached-accountservice-metadata-lock", pod=~"prod-p98-memcached-accountservice-metadata-lock-.*", pod!~"prod-p98-memcached-accountservice-metadata-lock-test-.*"}[5m])
//    )> 0.8"""
//
//    println(Parser.queryRangeToLogicalPlan(query, TimeStepParams(start = 100, step = 1, end = 110)).isRoutable)
//
//    val cardStore = new RocksDbCardinalityStore(DatasetRef("test"), 10)
//    val children = cardStore.scanChildren(List("aci-telemetry", "hubble-probes"), 3)
//    println(children)



    try {

      val columns = Seq("timestamp:ts", "min:double", "avg:double", "max:double", "count:long")
      val options = DatasetOptions.DefaultOptions.copy(metricColumn = "series")
      val dataset1 = Dataset("metrics1", Seq("series:string"), columns, options)
      @scala.annotation.unused val schema1 = dataset1.schema.partition
      //
      //      val conf = ConfigFactory.parseFile(new File("conf/timeseries-filodb-server.conf")).resolve()
      //      val settings = new DownsamplerSettings(conf)
      //      val rawDatasetRef = DatasetRef(settings.rawDatasetName)
      //      val downsampleConfig = DownsampleConfig.downsampleConfigFromSource(sourceConfig)
      //      val downsampleTtls = downsampleConfig.ttls
      //      val downsampledDatasetRefs = downsampleConfig.downsampleDatasetRefs(rawDatasetRef.dataset)
      //
      //      val indexDataset = downsampledDatasetRefs.last
      //      val indexTtlMs = downsampleTtls.last.toMillis

//      val idx = new PartKeyLuceneIndex(dataset1.ref, schema1, false,
//        false, 10, Long.MaxValue,
//        Some(new java.io.File("/Users/amolnayak/prod_index_copy")),
//        None,
//        useMemoryMappedImpl = false
//      )
//
//      val partKey = Array.fill(1000)((scala.util.Random.nextInt(256) - 128).toByte)
//
//      Range.inclusive(0, 20000000).foreach( i => {
//        idx.addPartKey(partKey, i, i)()
//        if (i % 10000 == 0)
//          println(s"Added ${i} documents")
//      })
//      //val docsCount = idx.getAllDocsCount()
//      //println(docsCount)

      val snapFos = new FileOutputStream(new File("snapFile"))

      snapFos.write(0x5c)
      val buff = ByteBuffer.allocate(8)
      buff.putLong(1688032800L)
      snapFos.write(buff.array())
      snapFos.close()
    } catch {
      case e: Exception => e.printStackTrace()
    }

  }

  def combinations[T](choices: List[List[T]]): List[List[T]] = choices match {
    case Nil          => Nil
    case head :: Nil  => head.map(List(_))
    case head :: tail =>
      val remainingCombinations = combinations(tail)
      head.flatMap( t => {
        remainingCombinations.map(t :: _)
      })
  }
}
//scalastyle:on